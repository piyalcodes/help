<html>

<head>
<style>
body {
  padding: 20px;
}
ul { 
  list-style: none;
  margin: 5px 20px;
}
li {
  margin: 0px 0;
}
</style>
<script type="text/javascript">

document.addEventListener("DOMContentLoaded", function(event) {  

	var getAllCheckBox =  document.querySelectorAll('input[type=checkbox]'); 

	for(var i = 0; i<= getAllCheckBox.length; i++){
 
		if(getAllCheckBox[i]) {

			getAllCheckBox[i].addEventListener('change', function (e) { 
			  
				var checked = e.srcElement.checked,
				container = e.srcElement.parentElement,
				siblings = container.childNodes;			 
			  
				siblings.forEach(function(item){
					
					if(item.checked != undefined) {
						
						if(item.checked == true) {
							
							// loop childrens
							readChildrens(item, item.checked)								
								
							// loop parents
							readParents(item, item.checked)
							
						} else {							
							
							// loop childrens
							readChildrens(item, item.checked)

							// loop parents
							readParents(item, item.checked)
							
						}						
					}					
				})				
			})		
		}
	}
	
	function readChildrens(el, st) {
		
		// loop childrens
		[].forEach.call(el.parentElement.parentElement.querySelectorAll('input[type=checkbox]'), function(item) {
			item.checked =  st;
			item.indeterminate =  false;
		});
	} 
	
	function readParents(el, st) {
	
		var childCount = el.parentElement.parentElement.parentElement.querySelectorAll('ul input[type=checkbox]:checked').length;
		var childSelectedCount = el.parentElement.parentElement.parentElement.querySelectorAll('ul input[type=checkbox]').length;
	
		if(el.parentElement.parentElement.parentElement.getAttribute("class") != "main_") {
	 
			var item = el.parentElement.parentElement.parentElement.parentElement.querySelectorAll('ul')[0].parentElement.querySelectorAll('input[type=checkbox]')[0];		
				 
			if(childCount == 0) {
				 
				item.checked =  false;
				item.indeterminate =  false;
					
			} else if(childCount != childSelectedCount) {
						 
				item.checked =  false;
				item.indeterminate =  true;
					
			} else {
				 
				item.checked =  true;
				item.indeterminate =  false;
			}						
			
			readParents(item, st);			
		}
	}
}); 
</script>

 
</head>
<body>
<ul class="main_">
  <li>
	<span class="styles">
		<input type="checkbox" name="tall" id="tall">
		<label for="tall">Tall Things</label>
	</span>	

    <ul>
      <li>
		<span class="styles">
			<input type="checkbox" name="tall-1" id="tall-1">
			<label for="tall-1">Buildings</label>
		</span>	
      </li>
      <li>
		<span class="styles">
			<input type="checkbox" name="tall-2" id="tall-2">
			<label for="tall-2">Giants</label>
		</span>	
        <ul>
          <li>
			<span class="styles">
				<input type="checkbox" name="tall-2-1" id="tall-2-1">
				<label for="tall-2-1">Andre</label>
			</span>
          </li>
		  
          <li>
			<span class="styles">
				<input type="checkbox" name="tall-2-2" id="tall-2-2">
				<label for="tall-2-2">Paul Bunyan</label>
			</span>
				<ul>
				  <li>
					<span class="styles">
						<input type="checkbox" name="tall-2-1" id="tall-2-1">
						<label for="tall-2-1">Andre</label>
						</span>
				  </li>
				  <li>
					<span class="styles">
					<input type="checkbox" name="tall-2-2" id="tall-2-2">
					<label for="tall-2-2">Paul Bunyan</label>
					</span>
				  </li>
			</ul>
		
		
          </li>
		  
		   <li>
				<span class="styles">
				<input type="checkbox" name="tall-2-2" id="tall-2-2">
				<label for="tall-2-2">Paul Bunyan</label>
				</span>
				<ul>
			  <li>
				<span class="styles">
				<input type="checkbox" name="tall-2-1" id="tall-2-1">
				<label for="tall-2-1">Andre</label>
				</span>
			  </li>
			  <li>
				<span class="styles">
				<input type="checkbox" name="tall-2-2" id="tall-2-2">
				<label for="tall-2-2">Paul Bunyan</label>
				</span>
			  </li>
			</ul>
		
		
          </li>
		   <li>
			<span class="styles">
            <input type="checkbox" name="tall-2-2" id="tall-2-2">
            <label for="tall-2-2">Paul Bunyan</label>
			</span>
				<ul>
			  <li>
				<span class="styles">
				<input type="checkbox" name="tall-2-1" id="tall-2-1">
				<label for="tall-2-1">Andre</label>
				</span>
			  </li>
			  <li>
				<span class="styles">
				<input type="checkbox" name="tall-2-2" id="tall-2-2">
				<label for="tall-2-2">Paul Bunyan</label>
				</span>
			  </li>
			</ul>
		
		
          </li>
        </ul>
      </li>
      <li>
	  <span class="styles">
        <input type="checkbox" name="tall-3" id="tall-3">
        <label for="tall-3">Two sandwiches</label>
        </span>
        <ul>
          <li>
		  <span class="styles">
            <input type="checkbox" name="tall-2-1" id="tall-2-1">
            <label for="tall-2-1">Andre</label>
			</span>
          </li>
          <li>
		  <span class="styles">
            <input type="checkbox" name="tall-2-2" id="tall-2-2">
            <label for="tall-2-2">Paul Bunyan</label>
			</span>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
  <span class="styles">
    <input type="checkbox" name="short" id="short">
    <label for="short">Short Things</label>
	</span>

    <ul>
      <li>
	  <span class="styles">
        <input type="checkbox" name="short-1" id="short-1">
        <label for="short-1">Smurfs</label> 
		</span>
      </li>
      <li>
	  <span class="styles">
        <input type="checkbox" name="short-2" id="short-2">
        <label for="short-2">Mushrooms</label>
		</span>
      </li>
      <li>
	  <span class="styles">
        <input type="checkbox" name="short-3" id="short-3">
        <label for="short-3">One Sandwich</label>
		</span>
      </li>
    </ul>
  </li>
 
   
</ul>
</body>

</html>


